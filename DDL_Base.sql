-- MySQL Script generated by Marlow
-- Wed June  5 2025

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema myholylib
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `myholylib` DEFAULT CHARACTER SET utf8 ;
USE `myholylib` ;

-- -----------------------------------------------------
-- Table `myholylib`.`BIB_BIBLIOTECA_SEDES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_BIBLIOTECA_SEDES` (
  `ID_SEDE` INT NOT NULL AUTO_INCREMENT,
  `NOMBRE` VARCHAR(100) NOT NULL,
  `DIRECCION` VARCHAR(150) NOT NULL,
  `DISTRITO` VARCHAR(50) NOT NULL,
  `TELEFONO_CONTACTO` VARCHAR(15) NOT NULL,
  `CORREO_CONTACTO` VARCHAR(100) NOT NULL,
  `ACTIVA` TINYINT(0) NOT NULL,
  PRIMARY KEY (`ID_SEDE`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_NIVELES_INGLES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_NIVELES_INGLES` (
  `ID_NIVEL` INT NOT NULL AUTO_INCREMENT,
  `NIVEL` ENUM('BASICO', 'INTERMEDIO', 'AVANZADO') NOT NULL,
  `DESCRIPCION` VARCHAR(255) NULL,
  PRIMARY KEY (`ID_NIVEL`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_PERSONAS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_PERSONAS` (
  `ID_PERSONA` INT NOT NULL AUTO_INCREMENT,
  `CODIGO` VARCHAR(6) NOT NULL,
  `NOMBRE` VARCHAR(100) NOT NULL,
  `PATERNO` VARCHAR(50) NOT NULL,
  `MATERNO` VARCHAR(50) NOT NULL,
  `DIRECCION` VARCHAR(150) NOT NULL,
  `TELEFONO` VARCHAR(15) NOT NULL,
  `CORREO` VARCHAR(100) NOT NULL,
  `CONTRASENHA` VARCHAR(25) NOT NULL,
  `TIPO_PERSONA` ENUM('PROFESOR', 'ADMINISTRADOR', 'ESTUDIANTE') NOT NULL,
  `TURNO` ENUM('MANHANA', 'TARDE', 'NOCHE') NULL,
  `FECHA_CONTRATO_INI` DATE NULL,
  `FECHA_CONTRATO_FIN` DATE NULL,
  `DEUDA_ACUMULADA` DOUBLE DEFAULT 0,
  `FECHA_SANCION_FIN` DATE NULL DEFAULT NULL,
  `VIGENTE` TINYINT(0) NULL,
  `NIVEL_IDNIVEL` INT NULL,
  `SEDE_IDSEDE` INT NOT NULL,
  PRIMARY KEY (`ID_PERSONA`),
  INDEX `fk_BIB_PERSONAS_BIB_SEDE1_idx` (`SEDE_IDSEDE` ASC) VISIBLE,
  INDEX `fk_BIB_PERSONAS_BIB_NIVELES_INGLES1_idx` (`NIVEL_IDNIVEL` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_PERSONAS_BIB_SEDE1`
    FOREIGN KEY (`SEDE_IDSEDE`)
    REFERENCES `myholylib`.`BIB_BIBLIOTECA_SEDES` (`ID_SEDE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_PERSONAS_BIB_NIVELES_INGLES1`
  FOREIGN KEY (`NIVEL_IDNIVEL`)
  REFERENCES `myholylib`.`BIB_NIVELES_INGLES` (`ID_NIVEL`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_PRESTAMOS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_PRESTAMOS` (
  `ID_PRESTAMO` INT NOT NULL AUTO_INCREMENT,
  `FECHA_SOLICITUD` DATE NOT NULL,
  `FECHA_PRESTAMO` DATE NULL,
  `FECHA_DEVOLUCION` DATE NULL, 
  `PERSONA_IDPERSONA` INT NOT NULL,
  PRIMARY KEY (`ID_PRESTAMO`),
  INDEX `fk_BIB_PRESTAMOS_BIB_PERSONAS_idx` (`PERSONA_IDPERSONA` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_PRESTAMOS_BIB_PERSONAS`
    FOREIGN KEY (`PERSONA_IDPERSONA`)
    REFERENCES `myholylib`.`BIB_PERSONAS` (`ID_PERSONA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_REPORTES_POR_SEDE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_REPORTES_POR_SEDE` (
  `ANHIO` INT NOT NULL,
  `MES` INT NOT NULL,
  `PRESTAMO_IDPRESTAMO` INT NOT NULL,
  `SEDE_IDSEDE` INT NOT NULL,
  `PERSONA_IDPERSONA` INT NOT NULL,
  PRIMARY KEY (`ANHIO`, `MES`, `PRESTAMO_IDPRESTAMO`, `SEDE_IDSEDE`, `PERSONA_IDPERSONA`),
  INDEX `fk_BIB_REPORTES_POR_SEDE_BIB_SEDE1_idx` (`SEDE_IDSEDE` ASC) VISIBLE,
  INDEX `fk_BIB_REPORTES_POR_SEDE_BIB_PRESTAMOS_idx` (`PRESTAMO_IDPRESTAMO` ASC) VISIBLE,
  INDEX `fk_BIB_REPORTES_POR_SEDE_BIB_PERSONAS_idx` (`PERSONA_IDPERSONA` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_REPORTES_POR_SEDE_BIB_SEDE1`
    FOREIGN KEY (`SEDE_IDSEDE`)
    REFERENCES `myholylib`.`BIB_BIBLIOTECA_SEDES` (`ID_SEDE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_REPORTES_POR_SEDE_BIB_PRESTAMOS`
    FOREIGN KEY (`PRESTAMO_IDPRESTAMO`)
    REFERENCES `myholylib`.`BIB_PRESTAMOS` (`ID_PRESTAMO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_REPORTES_POR_SEDE_BIB_PERSONAS`
    FOREIGN KEY (`PERSONA_IDPERSONA`)
    REFERENCES `myholylib`.`BIB_PERSONAS` (`ID_PERSONA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_REPORTES_GENERALES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_REPORTES_GENERALES` (
  `ANHIO` INT NOT NULL,
  `MES` INT NOT NULL,
  `PRESTAMO_IDPRESTAMO` INT NOT NULL,
  `PERSONA_IDPERSONA` INT NOT NULL,
  PRIMARY KEY (`ANHIO`, `PRESTAMO_IDPRESTAMO`, `MES`, `PERSONA_IDPERSONA`),
  INDEX `fk_BIB_REPORTES_GENERALES_BIB_PRESTAMOS_idx` (`PRESTAMO_IDPRESTAMO` ASC) VISIBLE,
  INDEX `fk_BIB_REPORTES_GENERALES_BIB_PERSONAS_idx` (`PERSONA_IDPERSONA` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_REPORTES_GENERALES_BIB_PRESTAMOS`
    FOREIGN KEY (`PRESTAMO_IDPRESTAMO`)
    REFERENCES `myholylib`.`BIB_PRESTAMOS` (`ID_PRESTAMO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_REPORTES_GENERALES_BIB_PERSONAS`
    FOREIGN KEY (`PERSONA_IDPERSONA`)
    REFERENCES `myholylib`.`BIB_PERSONAS` (`ID_PERSONA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_EDITORIALES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_EDITORIALES` (
  `ID_EDITORIAL` INT NOT NULL AUTO_INCREMENT,
  `NOMBRE` VARCHAR(45) NOT NULL,
  `SITIOWEB` VARCHAR(100) NULL DEFAULT NULL,
  `PAIS` VARCHAR(50) NULL,
  PRIMARY KEY (`ID_EDITORIAL`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_MATERIALES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_MATERIALES` (
  `ID_MATERIAL` INT NOT NULL AUTO_INCREMENT,
  `TITULO` VARCHAR(100) NOT NULL,
  `EDICION` VARCHAR(45) NULL,                               
  `ANHIO_PUBLICACION` INT NULL,
  `PORTADA` VARCHAR(255) NULL,
  `VIGENTE` TINYINT(0) NOT NULL,     
  `NIVEL_IDNIVEL` INT NULL,                
  `EDITORIAL_IDEDITORIAL` INT NULL,  
  PRIMARY KEY (`ID_MATERIAL`),
  INDEX `fk_BIB_MATERIALES_MAT_EDITORIAL1_idx` (`EDITORIAL_IDEDITORIAL` ASC) VISIBLE,
  INDEX `fk_BIB_MATERIALES_BIB_NIVELES_INGLES1_idx` (`NIVEL_IDNIVEL` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_MATERIALES_MAT_EDITORIAL1`
    FOREIGN KEY (`EDITORIAL_IDEDITORIAL`)
    REFERENCES `myholylib`.`BIB_EDITORIALES` (`ID_EDITORIAL`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_MATERIALES_BIB_NIVELES_INGLES1`
  FOREIGN KEY (`NIVEL_IDNIVEL`)
  REFERENCES `myholylib`.`BIB_NIVELES_INGLES` (`ID_NIVEL`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_TEMAS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_TEMAS` (
  `ID_TEMA` INT NOT NULL AUTO_INCREMENT,
  `DESCRIPCION` VARCHAR(100) NOT NULL,
  `CATEGORIA` ENUM('GENERO', 'EDAD') NOT NULL,
  `ID_TEMA_PADRE` INT NULL,
  PRIMARY KEY (`ID_TEMA`),
  INDEX `fk_BIB_TEMAS_BIB_TEMAS_idx` (`ID_TEMA_PADRE` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_TEMAS_BIB_TEMAS`
    FOREIGN KEY (`ID_TEMA_PADRE`)
    REFERENCES `myholylib`.`BIB_TEMAS` (`ID_TEMA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_EJEMPLARES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_EJEMPLARES` (
  `ID_EJEMPLAR` INT NOT NULL AUTO_INCREMENT,
  `FECHA_ADQUISICION` DATE NULL,            
  `DISPONIBLE` TINYINT(0) NOT NULL,                
  `TIPO_EJEMPLAR` ENUM('FISICO', 'DIGITAL') NOT NULL,
  `FORMATO_DIGITAL` ENUM('MP3', 'PDF', 'CBR', 'PPT') NULL,
  `UBICACION` VARCHAR(70) NULL,
  `SEDE_IDSEDE` INT NOT NULL,
  `MATERIAL_IDMATERIAL` INT NOT NULL,
  PRIMARY KEY (`ID_EJEMPLAR`),
  INDEX `fk_MAT_EJEMPLAR_BIB_SEDE1_idx` (`SEDE_IDSEDE` ASC) VISIBLE,
  INDEX `fk_MAT_EJEMPLAR_BIB_MATERIALES1_idx` (`MATERIAL_IDMATERIAL` ASC) VISIBLE,
  CONSTRAINT `fk_MAT_EJEMPLAR_BIB_SEDE1`
    FOREIGN KEY (`SEDE_IDSEDE`)
    REFERENCES `myholylib`.`BIB_BIBLIOTECA_SEDES` (`ID_SEDE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_MAT_EJEMPLAR_BIB_MATERIALES1`
    FOREIGN KEY (`MATERIAL_IDMATERIAL`)
    REFERENCES `myholylib`.`BIB_MATERIALES` (`ID_MATERIAL`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_SANCIONES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_SANCIONES` (
  `ID_SANCION` INT NOT NULL AUTO_INCREMENT,
  `TIPO` ENUM('DANHO', 'PERDIDA', 'DEMORA', 'EXCEPCION') NOT NULL,
  `FECHA` DATE NOT NULL,
  `MONTO` DOUBLE NULL DEFAULT NULL,
  `DURACION` DATE NULL DEFAULT NULL,         
  `DESCRIPCION` VARCHAR(150) NULL DEFAULT NULL,        
  `PRESTAMO_IDPRESTAMO` INT NOT NULL,
  PRIMARY KEY (`ID_SANCION`),
  INDEX `fk_BIB_SANCIONES_BIB_PRESTAMOS1_idx` (`PRESTAMO_IDPRESTAMO` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_SANCIONES_BIB_PRESTAMOS1`
    FOREIGN KEY (`PRESTAMO_IDPRESTAMO`)
    REFERENCES `myholylib`.`BIB_PRESTAMOS` (`ID_PRESTAMO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_CREADORES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_CREADORES` ( 
  `ID_CREADOR` INT NOT NULL AUTO_INCREMENT,
  `NOMBRE` VARCHAR(150) NOT NULL,
  `PATERNO` VARCHAR(50) NULL,
  `MATERNO` VARCHAR(50) NULL,
  `SEUDONIMO` VARCHAR(50) NULL,
  `TIPO_CREADOR` ENUM('AUTOR', 'TRADUCTOR', 'ILUSTRADOR', 'NARRADOR', 'EDITOR', 'GUIONISTA', 'DISENADOR_EDITORIAL', 'OTRO') NOT NULL,
  `NACIONALIDAD` VARCHAR(50) NULL, 
  `ACTIVO` TINYINT(0) NOT NULL,
  PRIMARY KEY (`ID_CREADOR`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_PRESTAMOS_DE_EJEMPLARES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_PRESTAMOS_DE_EJEMPLARES` (
  `PRESTAMO_IDPRESTAMO` INT NOT NULL,
  `EJEMPLAR_IDEJEMPLAR` INT NOT NULL,
  `ESTADO` ENUM('SOLICITADO', 'PRESTADO', 'DEVUELTO', 'ATRASADO') NOT NULL,
  `FECHA_REAL_DEVOLUCION` DATE NULL DEFAULT NULL,
  PRIMARY KEY (`PRESTAMO_IDPRESTAMO`, `EJEMPLAR_IDEJEMPLAR`),
  INDEX `fk_BIB_PRESTAMOS_has_MAT_EJEMPLAR_MAT_EJEMPLAR1_idx` (`EJEMPLAR_IDEJEMPLAR` ASC) VISIBLE,
  INDEX `fk_BIB_PRESTAMOS_has_MAT_EJEMPLAR_BIB_PRESTAMOS1_idx` (`PRESTAMO_IDPRESTAMO` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_PRESTAMOS_has_MAT_EJEMPLAR_BIB_PRESTAMOS1`
    FOREIGN KEY (`PRESTAMO_IDPRESTAMO`)
    REFERENCES `myholylib`.`BIB_PRESTAMOS` (`ID_PRESTAMO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_PRESTAMOS_has_MAT_EJEMPLAR_MAT_EJEMPLAR1`
    FOREIGN KEY (`EJEMPLAR_IDEJEMPLAR`)
    REFERENCES `myholylib`.`BIB_EJEMPLARES` (`ID_EJEMPLAR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_MATERIALES_TEMAS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_MATERIALES_TEMAS` (
  `MATERIAL_IDMATERIAL` INT NOT NULL,
  `TEMA_IDTEMA` INT NOT NULL,
  PRIMARY KEY (`MATERIAL_IDMATERIAL`, `TEMA_IDTEMA`),
  INDEX `fk_BIB_MATERIAL_has_MAT_TEMA_MAT_TEMA1_idx` (`TEMA_IDTEMA` ASC) VISIBLE,
  INDEX `fk_BIB_MATERIAL_has_MAT_TEMA_BIB_MATERIAL1_idx` (`MATERIAL_IDMATERIAL` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_MATERIAL_has_MAT_TEMA_BIB_MATERIAL1`
    FOREIGN KEY (`MATERIAL_IDMATERIAL`)
    REFERENCES `myholylib`.`BIB_MATERIAL` (`ID_MATERIAL`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_MATERIAL_has_MAT_TEMA_MAT_TEMA1`
    FOREIGN KEY (`TEMA_IDTEMA`)
    REFERENCES `myholylib`.`BIB_TEMAS` (`ID_TEMA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `myholylib`.`BIB_MATERIALES_CREADORES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `myholylib`.`BIB_MATERIALES_CREADORES` (
  `MATERIAL_IDMATERIAL` INT NOT NULL,
  `CREADOR_IDCREADOR` INT NOT NULL,
  PRIMARY KEY (`MATERIAL_IDMATERIAL`, `CREADOR_IDCREADOR`),
  INDEX `fk_BIB_MATERIAL_has_BIB_CREADORES_BIB_CREADORES1_idx` (`CREADOR_IDCREADOR` ASC) VISIBLE,
  INDEX `fk_BIB_MATERIAL_has_BIB_CREADORES_BIB_MATERIAL1_idx` (`MATERIAL_IDMATERIAL` ASC) VISIBLE,
  CONSTRAINT `fk_BIB_MATERIAL_has_BIB_CREADORES_BIB_MATERIAL1`
    FOREIGN KEY (`MATERIAL_IDMATERIAL`)
    REFERENCES `myholylib`.`BIB_MATERIAL` (`ID_MATERIAL`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BIB_MATERIAL_has_BIB_CREADORES_BIB_CREADORES1`
    FOREIGN KEY (`CREADOR_IDCREADOR`)
    REFERENCES `myholylib`.`BIB_CREADORES` (`ID_CREADOR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
